/* Copyright (c) Microsoft Open Technologies, Inc. All rights reserved. See License.txt in the project root for license information.*/
(function(a){var b={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},c=b[typeof window]&&window||this,d=b[typeof exports]&&exports&&!exports.nodeType&&exports,e=b[typeof module]&&module&&!module.nodeType&&module,f=(e&&e.exports===d&&d,b[typeof global]&&global);!f||f.global!==f&&f.window!==f||(c=f),"function"==typeof define&&define.amd?define(["rx-lite"],function(b,d){return a(c,d,b)}):"object"==typeof module&&module&&module.exports===d?module.exports=a(c,module.exports,require("rx-lite")):c.Rx=a(c,{},c.Rx)}).call(this,function(a,b,c){var d=c.Observable,e=d.prototype,f=c.AnonymousObservable,g=d.defer,h=(d.empty,d.never),i=d.throwException,j=(d.fromArray,c.Scheduler["default"]),k=c.SingleAssignmentDisposable,l=c.SerialDisposable,m=c.CompositeDisposable,n=c.RefCountDisposable,o=c.Subject,p=c.internals.addRef,q=(c.Scheduler.normalize,c.helpers),r=q.isPromise,s=q.isFunction,t=c.Scheduler.isScheduler,u=d.fromPromise;return e.windowWithTime=function(a,b,c){var d,e=this;return null==b&&(d=a),t(c)||(c=j),"number"==typeof b?d=b:t(b)&&(d=a,c=b),new f(function(b){function f(){var a=new k,e=!1,g=!1;r.setDisposable(a),j===i?(e=!0,g=!0):i>j?e=!0:g=!0;var l=e?j:i,m=l-s;s=l,e&&(j+=d),g&&(i+=d),a.setDisposable(c.scheduleWithRelative(m,function(){if(g){var a=new o;q.push(a),b.onNext(p(a,h))}e&&q.shift().onCompleted(),f()}))}var g,h,i=d,j=a,q=[],r=new l,s=0;return g=new m(r),h=new n(g),q.push(new o),b.onNext(p(q[0],h)),f(),g.add(e.subscribe(function(a){for(var b=0,c=q.length;c>b;b++)q[b].onNext(a)},function(a){for(var c=0,d=q.length;d>c;c++)q[c].onError(a);b.onError(a)},function(){for(var a=0,c=q.length;c>a;a++)q[a].onCompleted();b.onCompleted()})),h},e)},e.windowWithTimeOrCount=function(a,b,c){var d=this;return t(c)||(c=j),new f(function(e){function f(b){var d=new k;g.setDisposable(d),d.setDisposable(c.scheduleWithRelative(a,function(){if(b===q){j=0;var a=++q;r.onCompleted(),r=new o,e.onNext(p(r,i)),f(a)}}))}var g=new l,h=new m(g),i=new n(h),j=0,q=0,r=new o;return e.onNext(p(r,i)),f(0),h.add(d.subscribe(function(a){var c=0,d=!1;r.onNext(a),++j===b&&(d=!0,j=0,c=++q,r.onCompleted(),r=new o,e.onNext(p(r,i))),d&&f(c)},function(a){r.onError(a),e.onError(a)},function(){r.onCompleted(),e.onCompleted()})),i},d)},e.bufferWithTime=function(){return this.windowWithTime.apply(this,arguments).selectMany(function(a){return a.toArray()})},e.bufferWithTimeOrCount=function(a,b,c){return this.windowWithTimeOrCount(a,b,c).selectMany(function(a){return a.toArray()})},e.timeInterval=function(a){var b=this;return t(a)||(a=j),g(function(){var c=a.now();return b.map(function(b){var d=a.now(),e=d-c;return c=d,{value:b,interval:e}})})},d.generateWithAbsoluteTime=function(a,b,c,d,e,g){return t(g)||(g=j),new f(function(f){var h,i,j=!0,k=!1,l=a;return g.scheduleRecursiveWithAbsolute(g.now(),function(a){k&&f.onNext(h);try{j?j=!1:l=c(l),k=b(l),k&&(h=d(l),i=e(l))}catch(g){return void f.onError(g)}k?a(i):f.onCompleted()})})},d.generateWithRelativeTime=function(a,b,c,d,e,g){return t(g)||(g=j),new f(function(f){var h,i,j=!0,k=!1,l=a;return g.scheduleRecursiveWithRelative(0,function(a){k&&f.onNext(h);try{j?j=!1:l=c(l),k=b(l),k&&(h=d(l),i=e(l))}catch(g){return void f.onError(g)}k?a(i):f.onCompleted()})})},e.delaySubscription=function(a,b){var c=a instanceof Date?"scheduleWithAbsolute":"scheduleWithRelative",d=this;return t(b)||(b=j),new f(function(e){var f=new l;return f.setDisposable(b[c](a,function(){f.setDisposable(d.subscribe(e))})),f},this)},e.delayWithSelector=function(a,b){var c,d,e=this;return s(a)?d=a:(c=a,d=b),new f(function(a){function b(){i.setDisposable(e.subscribe(function(b){var c=d(b),e=new k;g.add(e),e.setDisposable(c.subscribe(function(){a.onNext(b),g.remove(e),f()},function(b){a.onError(b)},function(){a.onNext(b),g.remove(e),f()}))},function(b){a.onError(b)},function(){h=!0,i.dispose(),f()}))}function f(){h&&0===g.length&&a.onCompleted()}var g=new m,h=!1,i=new l;return c?i.setDisposable(c.subscribe(b,function(b){a.onError(b)},b)):b(),new m(i,g)},this)},e.timeoutWithSelector=function(a,b,c){1===arguments.length&&(b=a,a=h()),c||(c=i(new Error("Timeout")));var d=this;return new f(function(e){function f(a){function b(){return n===d}var d=n,f=new k;i.setDisposable(f),f.setDisposable(a.subscribe(function(){b()&&h.setDisposable(c.subscribe(e)),f.dispose()},function(a){b()&&e.onError(a)},function(){b()&&h.setDisposable(c.subscribe(e))}))}function g(){var a=!o;return a&&n++,a}var h=new l,i=new l,j=new k;h.setDisposable(j);var n=0,o=!1;return f(a),j.setDisposable(d.subscribe(function(a){if(g()){e.onNext(a);var c;try{c=b(a)}catch(d){return void e.onError(d)}f(r(c)?u(c):c)}},function(a){g()&&e.onError(a)},function(){g()&&e.onCompleted()})),new m(h,i)},d)},e.debounceWithSelector=function(a){var b=this;return new f(function(c){var d,e=!1,f=new l,g=0,h=b.subscribe(function(b){var h;try{h=a(b)}catch(i){return void c.onError(i)}r(h)&&(h=u(h)),e=!0,d=b,g++;var j=g,l=new k;f.setDisposable(l),l.setDisposable(h.subscribe(function(){e&&g===j&&c.onNext(d),e=!1,l.dispose()},c.onError.bind(c),function(){e&&g===j&&c.onNext(d),e=!1,l.dispose()}))},function(a){f.dispose(),c.onError(a),e=!1,g++},function(){f.dispose(),e&&c.onNext(d),c.onCompleted(),e=!1,g++});return new m(h,f)},b)},e.throttleWithSelector=function(a){return this.debounceWithSelector(a)},e.skipLastWithTime=function(a,b){t(b)||(b=j);var c=this;return new f(function(d){var e=[];return c.subscribe(function(c){var f=b.now();for(e.push({interval:f,value:c});e.length>0&&f-e[0].interval>=a;)d.onNext(e.shift().value)},function(a){d.onError(a)},function(){for(var c=b.now();e.length>0&&c-e[0].interval>=a;)d.onNext(e.shift().value);d.onCompleted()})},c)},e.takeLastWithTime=function(a,b){var c=this;return t(b)||(b=j),new f(function(d){var e=[];return c.subscribe(function(c){var d=b.now();for(e.push({interval:d,value:c});e.length>0&&d-e[0].interval>=a;)e.shift()},function(a){d.onError(a)},function(){for(var c=b.now();e.length>0;){var f=e.shift();c-f.interval<=a&&d.onNext(f.value)}d.onCompleted()})},c)},e.takeLastBufferWithTime=function(a,b){var c=this;return t(b)||(b=j),new f(function(d){var e=[];return c.subscribe(function(c){var d=b.now();for(e.push({interval:d,value:c});e.length>0&&d-e[0].interval>=a;)e.shift()},function(a){d.onError(a)},function(){for(var c=b.now(),f=[];e.length>0;){var g=e.shift();c-g.interval<=a&&f.push(g.value)}d.onNext(f),d.onCompleted()})},c)},e.takeWithTime=function(a,b){var c=this;return t(b)||(b=j),new f(function(d){return new m(b.scheduleWithRelative(a,function(){d.onCompleted()}),c.subscribe(d))},c)},e.skipWithTime=function(a,b){var c=this;return t(b)||(b=j),new f(function(d){var e=!1;return new m(b.scheduleWithRelative(a,function(){e=!0}),c.subscribe(function(a){e&&d.onNext(a)},d.onError.bind(d),d.onCompleted.bind(d)))},c)},e.skipUntilWithTime=function(a,b){t(b)||(b=j);var c=this,d=a instanceof Date?"scheduleWithAbsolute":"scheduleWithRelative";return new f(function(e){var f=!1;return new m(b[d](a,function(){f=!0}),c.subscribe(function(a){f&&e.onNext(a)},function(a){e.onError(a)},function(){e.onCompleted()}))},c)},e.takeUntilWithTime=function(a,b){t(b)||(b=j);var c=this,d=a instanceof Date?"scheduleWithAbsolute":"scheduleWithRelative";return new f(function(e){return new m(b[d](a,function(){e.onCompleted()}),c.subscribe(e))},c)},c});
//# sourceMappingURL=rx.lite.time.map